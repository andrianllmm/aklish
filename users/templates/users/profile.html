{% extends 'users/base.html' %}

{% block content %}
    <div class="container w-75 px-4">
        <div class="container pb-3 mb-3 border-bottom">
            <div class="mb-2">
                <h1>{{ user.username }}</h1>
            </div>
            <div class="text-muted">
                <div class="mb-1">
                    <small class="me-2">Member since {{ user.date_joined|date:'d M y' }}</small>
                    <small class="me-2">Last active {{ user.last_login|date:'d M y' }}</small>
                </div>
                <div class="mb-1">
                    <small class="me-2">{{ user.email }}</small>
                </div>
            </div>
        </div>
        <div class="container pb-3 mb-3 border-bottom">
            <div class="pb-3 mb-3">
                <h2 class="h5">
                    Stats
                </h2>
                <ul class="list-group">
                    <li class="list-group-item">
                        {{ user.profile.reputation }} reputation
                    </li>
                    <li class="list-group-item">
                        {{ user.entries.count }} entries
                    </li>
                    <li class="list-group-item">
                        {{ user.translations.count }} translations
                    </li>
                </ul>
            </div>
            <div class="pb-3 mb-3">
                <h2 class="h5">
                    Bookmarks
                </h2>
                <ul class="list-group">
                    {% for entry in user.bookmarks.all %}
                        <li class="list-group-item d-flex align-items-center">
                            <a href="{% url 'translations:entry' entry.id %}"
                            class="me-auto text-decoration-none">
                                {{ entry.content|slice:100 }}...
                            </a>
                            {% if request.user == user %}
                                <form method="POST">
                                    {% csrf_token %}
                                    <input type="hidden" name="entry_to_unbookmark_pk" value="{{ entry.pk }}">
                                    <input type="submit" name="remove_bookmark" value="Remove"
                                    class="btn btn-sm btn-danger">
                                </form>
                            {% endif %}
                        </li>
                    {% empty %}
                        <li class="list-group-item">
                            No bookmarks
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="pb-3 mb-3">
                <h2 class="h5">
                    Entries
                </h2>
                <ul class="list-group">
                    {% for entry in user.entries.all %}
                        <li class="list-group-item d-flex align-items-center">
                            <a href="{% url 'translations:entry' entry.id %}"
                            class="me-auto text-decoration-none">
                                {{ entry.content|slice:100 }}...
                            </a>
                            {% if request.user == user %}
                                <form method="POST">
                                    {% csrf_token %}
                                    <input type="hidden" name="entry_to_delete_pk" value="{{ entry.pk }}">
                                    <input type="submit" name="delete_entry" value="Delete"
                                    class="btn btn-sm btn-danger">
                                </form>
                            {% endif %}
                        </li>
                    {% empty %}
                        <li class="list-group-item">
                            No entries
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div>
                <h2 class="h5">
                    Translations
                </h2>
                <ul class="list-group">
                    {% for translation in user.translations.all %}
                        <li class="list-group-item d-flex align-items-center">
                            <a href="{% url 'translations:entry' translation.entry.pk %}"
                            class="me-auto text-decoration-none">
                                {{ translation.content|slice:100 }}...
                            </a>
                            {% if request.user == user %}
                                <form method="POST">
                                    {% csrf_token %}
                                    <input type="hidden" name="translation_to_delete_pk" value="{{ translation.pk }}">
                                    <input type="submit" name="delete_translation" value="Delete"
                                    class="btn btn-sm btn-danger">
                                </form>
                            {% endif %}
                        </li>
                    {% empty %}
                        <li class="list-group-item">
                            No translations
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        {% if user == request.user %}
            <div class="container pb-3 mb-3">
                <a href="{% url 'users:logout' %}" class="btn btn-warning">Logout</a>
            </div>
        {% endif %}
    </div>
{% endblock %}